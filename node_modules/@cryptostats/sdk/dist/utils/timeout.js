"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.timeoutPromise = void 0;
async function timeoutPromise(promise, timeout) {
    let timeoutTimer;
    const result = await Promise.race([
        promise.catch(e => {
            if (timeoutTimer) {
                clearTimeout(timeoutTimer);
            }
            throw e;
        }),
        new Promise((_resolve, reject) => {
            timeoutTimer = setTimeout(() => reject(new Error(`Promise timed out after ${timeout / 1000}s`)), timeout);
        }),
    ]);
    // If the timeout is triggered, this line will never be reached
    clearTimeout(timeoutTimer);
    return result;
}
exports.timeoutPromise = timeoutPromise;
