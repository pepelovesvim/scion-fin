"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.RedisCache = void 0;
const redis_1 = __importDefault(require("redis"));
const util_1 = require("util");
class RedisCache {
    constructor(redisUrl, { redisLibrary = redis_1.default, } = {}) {
        this.client = redisLibrary.createClient({ url: redisUrl });
        this.get = util_1.promisify(this.client.get).bind(this.client);
        this.set = util_1.promisify(this.client.set).bind(this.client);
    }
    async getValue(name, type, key) {
        const value = await this.get(this.serialize(name, type, key));
        if (value && value !== 'NaN') {
            return parseFloat(value);
        }
        return null;
    }
    setValue(name, type, key, value) {
        return this.set(this.serialize(name, type, key), value);
    }
    serialize(name, type, key) {
        return `${name}-${type}-${key}`;
    }
}
exports.RedisCache = RedisCache;
